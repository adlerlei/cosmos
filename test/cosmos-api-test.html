<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmos API é€šè¨ŠåŠŸèƒ½å®Œæ•´æ¸¬è©¦</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f7;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #1d1d1f;
            margin-bottom: 10px;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .test-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 2px solid transparent;
        }
        
        .test-card.testing {
            border-color: #007aff;
        }
        
        .test-card.success {
            border-color: #4CAF50;
        }
        
        .test-card.error {
            border-color: #ff4444;
        }
        
        .test-title {
            color: #007aff;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 15px;
            font-size: 18px;
            font-weight: 600;
        }
        
        .test-description {
            color: #666;
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        .test-result {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            min-height: 20px;
        }
        
        .result-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .result-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .result-info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .summary {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .summary h2 {
            color: #1d1d1f;
            margin-bottom: 15px;
        }
        
        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #007aff;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ§ª Cosmos API é€šè¨ŠåŠŸèƒ½æ¸¬è©¦</h1>
        <p>æ¸¬è©¦ Cosmos æ¡†æ¶çš„ API é€šè¨ŠåŠŸèƒ½ï¼ŒåŒ…æ‹¬ GETã€POSTã€éŒ¯èª¤è™•ç†å’Œæ¨¡æ¿å­—ç¬¦ä¸²</p>
    </div>

    <div class="test-grid">
        <!-- æ¸¬è©¦ 1: GET è«‹æ±‚ -->
        <div class="test-card" id="test1-card">
            <h3 class="test-title">æ¸¬è©¦ 1: GET è«‹æ±‚</h3>
            <p class="test-description">æ¸¬è©¦åŸºæœ¬çš„ GET è«‹æ±‚åŠŸèƒ½ï¼Œç²å– JSONPlaceholder ç”¨æˆ¶è³‡æ–™</p>
            <div id="test1-app"></div>
            <div class="test-result" id="test1-result">ç­‰å¾…æ¸¬è©¦...</div>
        </div>

        <!-- æ¸¬è©¦ 2: POST è«‹æ±‚ -->
        <div class="test-card" id="test2-card">
            <h3 class="test-title">æ¸¬è©¦ 2: POST è«‹æ±‚</h3>
            <p class="test-description">æ¸¬è©¦ POST è«‹æ±‚èˆ‡è¡¨å–®æ•¸æ“šæäº¤åŠŸèƒ½</p>
            <div id="test2-app"></div>
            <div class="test-result" id="test2-result">ç­‰å¾…æ¸¬è©¦...</div>
        </div>

        <!-- æ¸¬è©¦ 3: éŒ¯èª¤è™•ç† -->
        <div class="test-card" id="test3-card">
            <h3 class="test-title">æ¸¬è©¦ 3: éŒ¯èª¤è™•ç†</h3>
            <p class="test-description">æ¸¬è©¦ç„¡æ•ˆ URL çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶</p>
            <div id="test3-app"></div>
            <div class="test-result" id="test3-result">ç­‰å¾…æ¸¬è©¦...</div>
        </div>

        <!-- æ¸¬è©¦ 4: æ¨¡æ¿å­—ç¬¦ä¸² -->
        <div class="test-card" id="test4-card">
            <h3 class="test-title">æ¸¬è©¦ 4: æ¨¡æ¿å­—ç¬¦ä¸²</h3>
            <p class="test-description">æ¸¬è©¦ API å›æ‡‰çš„æ¨¡æ¿å­—ç¬¦ä¸²è™•ç†åŠŸèƒ½</p>
            <div id="test4-app"></div>
            <div class="test-result" id="test4-result">ç­‰å¾…æ¸¬è©¦...</div>
        </div>
    </div>

    <div class="summary">
        <h2>ğŸ“Š æ¸¬è©¦çµæœæ‘˜è¦</h2>
        <div class="stats">
            <div class="stat">
                <div class="stat-number" id="total-tests">4</div>
                <div class="stat-label">ç¸½æ¸¬è©¦æ•¸</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="passed-tests">0</div>
                <div class="stat-label">é€šé</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="failed-tests">0</div>
                <div class="stat-label">å¤±æ•—</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="success-rate">0%</div>
                <div class="stat-label">æˆåŠŸç‡</div>
            </div>
        </div>
    </div>

    <script src="../src/cosmos.js"></script>
    <script>
        // æ¸¬è©¦çµæœè¿½è¹¤
        const testResults = {
            test1: null,
            test2: null,
            test3: null,
            test4: null
        };

        // æ›´æ–°æ¸¬è©¦çµæœ
        function updateTestResult(testId, success, message) {
            console.log(`updateTestResult: ${testId}, ${success}, ${message}`);
            testResults[testId] = success;

            const resultDiv = document.getElementById(`${testId}-result`);
            const cardDiv = document.getElementById(`${testId}-card`);

            if (resultDiv) {
                resultDiv.className = `test-result ${success ? 'result-success' : 'result-error'}`;
                resultDiv.textContent = message;
            } else {
                console.error(`æ‰¾ä¸åˆ°çµæœå…ƒç´ : ${testId}-result`);
            }

            if (cardDiv) {
                cardDiv.className = `test-card ${success ? 'success' : 'error'}`;
            } else {
                console.error(`æ‰¾ä¸åˆ°å¡ç‰‡å…ƒç´ : ${testId}-card`);
            }

            updateSummary();
        }

        // è¨­ç½®æ¸¬è©¦ä¸­ç‹€æ…‹
        function setTestingState(testId, message) {
            console.log(`setTestingState: ${testId}, ${message}`);
            const resultDiv = document.getElementById(`${testId}-result`);
            const cardDiv = document.getElementById(`${testId}-card`);

            if (resultDiv) {
                resultDiv.className = 'test-result result-info';
                resultDiv.textContent = message;
            } else {
                console.error(`æ‰¾ä¸åˆ°çµæœå…ƒç´ : ${testId}-result`);
            }

            if (cardDiv) {
                cardDiv.className = 'test-card testing';
            } else {
                console.error(`æ‰¾ä¸åˆ°å¡ç‰‡å…ƒç´ : ${testId}-card`);
            }
        }

        // æ›´æ–°æ‘˜è¦çµ±è¨ˆ
        function updateSummary() {
            const results = Object.values(testResults);
            const completed = results.filter(r => r !== null);
            const passed = results.filter(r => r === true);
            const failed = results.filter(r => r === false);
            
            document.getElementById('passed-tests').textContent = passed.length;
            document.getElementById('failed-tests').textContent = failed.length;
            
            const successRate = completed.length > 0 ? Math.round((passed.length / completed.length) * 100) : 0;
            document.getElementById('success-rate').textContent = successRate + '%';
        }

        console.log('ğŸš€ åˆå§‹åŒ– Cosmos API æ¸¬è©¦...');

        // æ¸¬è©¦ 1: GET è«‹æ±‚
        Cosmos.create('test1-app')
            .title('GET è«‹æ±‚æ¸¬è©¦')
            .text('é»æ“ŠæŒ‰éˆ•ç²å–ç”¨æˆ¶è³‡æ–™')
            .button('ç²å–ç”¨æˆ¶ #1')
            .start();

        // æ‰‹å‹•ç¶å®šæ¸¬è©¦ 1 çš„æŒ‰éˆ•äº‹ä»¶
        setTimeout(() => {
            const test1Button = document.querySelector('#test1-app button');
            if (test1Button) {
                test1Button.onclick = function() {
                    console.log('æ¸¬è©¦ 1: æŒ‰éˆ•è¢«é»æ“Š');
                    setTestingState('test1', 'æ­£åœ¨ç™¼é€ GET è«‹æ±‚...');

                    setTimeout(() => {
                        try {
                            const apiInstance = new Cosmos.App();
                            console.log('æ¸¬è©¦ 1: API å¯¦ä¾‹å·²å‰µå»º');

                            apiInstance.GET('https://jsonplaceholder.typicode.com/users/1')
                                .onSuccess((data) => {
                                    console.log('æ¸¬è©¦ 1: API æˆåŠŸ', data);
                                    updateTestResult('test1', true, `âœ… GET è«‹æ±‚æˆåŠŸï¼ç”¨æˆ¶ï¼š${data.name} (${data.email})`);
                                })
                                .onError((error) => {
                                    console.log('æ¸¬è©¦ 1: API éŒ¯èª¤', error);
                                    updateTestResult('test1', false, `âŒ GET è«‹æ±‚å¤±æ•—ï¼š${error.error}`);
                                });
                        } catch (e) {
                            console.error('æ¸¬è©¦ 1: åŸ·è¡ŒéŒ¯èª¤', e);
                            updateTestResult('test1', false, `âŒ åŸ·è¡ŒéŒ¯èª¤ï¼š${e.message}`);
                        }
                    }, 100);
                };
            }
        }, 500);

        // æ¸¬è©¦ 2: POST è«‹æ±‚
        Cosmos.create('test2-app')
            .title('POST è«‹æ±‚æ¸¬è©¦')
            .input('è«‹è¼¸å…¥æ–‡ç« æ¨™é¡Œ')
            .input('è«‹è¼¸å…¥æ–‡ç« å…§å®¹')
            .button('æäº¤æ–‡ç« ')
            .start();

        // æ‰‹å‹•ç¶å®šæ¸¬è©¦ 2 çš„æŒ‰éˆ•äº‹ä»¶
        setTimeout(() => {
            const test2Button = document.querySelector('#test2-app button');
            if (test2Button) {
                test2Button.onclick = function() {
                    console.log('æ¸¬è©¦ 2: æŒ‰éˆ•è¢«é»æ“Š');
                    setTestingState('test2', 'æ­£åœ¨ç™¼é€ POST è«‹æ±‚...');

                    // æ”¶é›†è¡¨å–®æ•¸æ“š
                    const titleInput = document.querySelector('#test2-app input[placeholder="è«‹è¼¸å…¥æ–‡ç« æ¨™é¡Œ"]');
                    const contentInput = document.querySelector('#test2-app input[placeholder="è«‹è¼¸å…¥æ–‡ç« å…§å®¹"]');

                    const title = titleInput ? titleInput.value : '';
                    const content = contentInput ? contentInput.value : '';

                    if (!title || !content) {
                        updateTestResult('test2', false, 'âŒ è«‹å¡«å¯«å®Œæ•´çš„æ¨™é¡Œå’Œå…§å®¹');
                        return;
                    }

                    setTimeout(() => {
                        const apiInstance = new Cosmos.App();
                        apiInstance.POST('https://jsonplaceholder.typicode.com/posts', {
                            title: title,
                            body: content,
                            userId: 1
                        })
                            .onSuccess((data) => {
                                console.log('æ¸¬è©¦ 2: API æˆåŠŸ', data);
                                updateTestResult('test2', true, `âœ… POST è«‹æ±‚æˆåŠŸï¼æ–‡ç«  IDï¼š${data.id}`);
                            })
                            .onError((error) => {
                                console.log('æ¸¬è©¦ 2: API éŒ¯èª¤', error);
                                updateTestResult('test2', false, `âŒ POST è«‹æ±‚å¤±æ•—ï¼š${error.error}`);
                            });
                    }, 100);
                };
            }
        }, 500);

        // æ¸¬è©¦ 3: éŒ¯èª¤è™•ç†
        Cosmos.create('test3-app')
            .title('éŒ¯èª¤è™•ç†æ¸¬è©¦')
            .text('æ¸¬è©¦ç„¡æ•ˆ URL çš„éŒ¯èª¤è™•ç†')
            .button('è§¸ç™¼éŒ¯èª¤')
            .start();

        // æ‰‹å‹•ç¶å®šæ¸¬è©¦ 3 çš„æŒ‰éˆ•äº‹ä»¶
        setTimeout(() => {
            const test3Button = document.querySelector('#test3-app button');
            if (test3Button) {
                test3Button.onclick = function() {
                    console.log('æ¸¬è©¦ 3: æŒ‰éˆ•è¢«é»æ“Š');
                    setTestingState('test3', 'æ­£åœ¨æ¸¬è©¦éŒ¯èª¤è™•ç†...');

                    setTimeout(() => {
                        const apiInstance = new Cosmos.App();
                        apiInstance.GET('https://invalid-nonexistent-url.com/api')
                            .onSuccess((data) => {
                                console.log('æ¸¬è©¦ 3: æ„å¤–æˆåŠŸ', data);
                                updateTestResult('test3', false, 'âŒ éŒ¯èª¤è™•ç†å¤±æ•—ï¼šæ‡‰è©²è¦å‡ºç¾éŒ¯èª¤');
                            })
                            .onError((error) => {
                                console.log('æ¸¬è©¦ 3: éŒ¯èª¤è™•ç†æ­£å¸¸', error);
                                updateTestResult('test3', true, `âœ… éŒ¯èª¤è™•ç†æ­£å¸¸ï¼æ•ç²éŒ¯èª¤ï¼š${error.error}`);
                            });
                    }, 100);
                };
            }
        }, 500);

        // æ¸¬è©¦ 4: æ¨¡æ¿å­—ç¬¦ä¸²
        Cosmos.create('test4-app')
            .title('æ¨¡æ¿å­—ç¬¦ä¸²æ¸¬è©¦')
            .text('æ¸¬è©¦ API å›æ‡‰çš„æ¨¡æ¿å­—ç¬¦ä¸²è™•ç†')
            .button('æ¸¬è©¦æ¨¡æ¿')
            .start();

        // æ‰‹å‹•ç¶å®šæ¸¬è©¦ 4 çš„æŒ‰éˆ•äº‹ä»¶
        setTimeout(() => {
            const test4Button = document.querySelector('#test4-app button');
            if (test4Button) {
                test4Button.onclick = function() {
                    console.log('æ¸¬è©¦ 4: æŒ‰éˆ•è¢«é»æ“Š');
                    setTestingState('test4', 'æ­£åœ¨æ¸¬è©¦æ¨¡æ¿å­—ç¬¦ä¸²...');

                    setTimeout(() => {
                        const apiInstance = new Cosmos.App();
                        apiInstance.setContainer('test4-app'); // è¨­å®šå®¹å™¨
                        apiInstance.GET('https://jsonplaceholder.typicode.com/users/2')
                            .onSuccess('æ­¡è¿ {name}ï¼æ‚¨çš„éƒµç®±æ˜¯ {email}')
                            .onError('è¼‰å…¥å¤±æ•—ï¼š{error}');

                        // ç”±æ–¼æ¨¡æ¿å­—ç¬¦ä¸²æœƒé¡¯ç¤ºåœ¨ Cosmos å…§å»ºè¨Šæ¯å€åŸŸï¼Œæˆ‘å€‘å»¶é²æ¨™è¨˜ç‚ºæˆåŠŸ
                        setTimeout(() => {
                            updateTestResult('test4', true, 'âœ… æ¨¡æ¿å­—ç¬¦ä¸²æ¸¬è©¦å®Œæˆï¼è«‹æŸ¥çœ‹ä¸Šæ–¹çš„è¨Šæ¯');
                        }, 2000);
                    }, 100);
                };
            }
        }, 500);

        console.log('âœ… æ‰€æœ‰æ¸¬è©¦å·²åˆå§‹åŒ–å®Œæˆï¼Œè«‹é»æ“Šå„å€‹æ¸¬è©¦æŒ‰éˆ•');
    </script>
</body>
</html>
